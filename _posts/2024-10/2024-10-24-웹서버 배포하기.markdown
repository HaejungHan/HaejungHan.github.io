---
title: TIL(20241024) [Spring Boot/JSP war Tomcat ì›¹ì„œë²„ ë°°í¬í•˜ê¸°(gradle)]
author: hanni
date: 2024-10-24 23:50:00 +0800
categories: TIL
tags: [SpringBoot, JSP, war, gradle, tomcat]
---

----------------------------------------------------------------------------


ì´ë²ˆì— ì§„í–‰í•  í”„ë¡œì íŠ¸ëŠ” ê°œì¸ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë ¤ê³  í•œë‹¤.<br>

ì£¼ì œëŠ” **ìœ íˆ¬ë²„ê°€ ë˜ê³  ì‹¶ì€ ì‚¬ëŒë“¤ì„ ìœ„í•œ ìœ íˆ¬ë¸Œ í†µê³„ë¶„ì„ ì›¹ì„œë¹„ìŠ¤**ì´ë‹¤.<br>

í”„ë¡ íŠ¸ë‹¨ì„ êµ¬ì„±í•˜ê¸° ìœ„í•œ ì™€ì´ì–´í”„ë ˆì„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.<br>

![image](https://github.com/user-attachments/assets/83428d5a-3a5a-4eb5-b689-6ff6d2703cfc)

ì´ì „ì— íƒ€ì„ë¦¬í”„ë¥¼ ì‚¬ìš©í•´ë´ì„œ ê·¸ëŸ°ì§€ JSPë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ í¬ê²Œ ì–´ë µë‹¤ê³  ëŠê»´ì§€ì§„ ì•Šì•˜ëŠ”ë°..<br>
ì•„ì§ ë°±ì—”ë“œì™€ DB, Youtube Data APIë¥¼ ì—°ê²°í•´ë³´ì§€ ì•Šì•„ì„œ ê·¸ëŸ°ì§€ ìŠ¤íŠ¸ë ˆìŠ¤ëŠ” ì—†ì§€ë§Œ..<br>
ì™ ì§€ í—˜ë‚œí•œ ì—¬ì •ì´ ë  ê²ƒ ê°™ë‹¤ë¼ëŠ” ìƒê°ì— .. ì ì‹œ ì‰¬ì–´ê°€ëŠ” ì°¨ì›ì—ì„œ(?)...<br>
í†°ìº£ìœ¼ë¡œ ì›¹ì„œë²„ ë°°í¬ë¥¼ ë¨¼ì € í•´ë³´ë ¤ê³  í•œë‹¤.<br>

ì•„ë˜ ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í•˜ë©° í–ˆë‹¤.<br>

[warë¡œ ë°°í¬í•˜ê¸°](https://a-curious.tistory.com/76)<br>
[warë¡œ ë°°í¬í•˜ê¸°, SpringBootServletInitalizer](https://teching.tistory.com/170)<br>


## ğŸ’¡ STEP 1. Application ì„¤ì • 

```java
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class, SecurityAutoConfiguration.class})
public class CreatorHubApplication extends SpringBootServletInitializer {

    public static void main(String[] args) {
        SpringApplication.run(CreatorHubApplication.class, args);
    }

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(CreatorHubApplication.class);
    }
}
```

jspë¥¼ ì‚¬ìš©í•˜ëŠ” ì›¹ì• í”Œë¦¬ì¼€ì´ì…˜ ê°™ì€ ê²½ìš°ì—ëŠ” warë¡œ ë¹Œë“œí•˜ì—¬ Tomcatì´ë‚˜ Jettyì™€ ê°™ì€ ì™¸ë¶€ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ í†µí•´ì„œ ë°°í¬ë¥¼ í•´ì•¼ í–ˆëŠ”ë° ì´ ê²½ìš°ì— SpringBootServletInitalizerë¥¼ ìƒì†ë°›ì•„ì„œ ì‹¤í–‰ë˜ë„ë¡ í•´ì•¼ í•œë‹¤.

#### build.gradle

```java
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.3.4'
    id 'io.spring.dependency-management' version '1.1.6'
    id 'war' // WAR
}

group = 'com.academy'
version = '0.0.1-SNAPSHOT'
apply plugin: 'war'

dependencies {
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
    
}

tasks.named('war') {
    enabled = true // WAR íŒŒì¼ ìƒì„± ê°€ëŠ¥
}

tasks.named('bootWar') {
    enabled = true // Spring Boot WAR ìƒì„± ê°€ëŠ¥
}
```

ê·¸ë¦¬ê³  í„°ë¯¸ë„ ì°½ì—ì„œ ë¹Œë“œí•œë‹¤.<br>

```
./gradlew clean build
```

ê·¸ëŸ¬ë©´ build/libs í´ë” ì•„ë˜ì— waríŒŒì¼ì´ ìƒì„±ëœë‹¤. <br>

![image](https://github.com/user-attachments/assets/5d5a1f10-877d-44ac-bb4d-d1086de9a58c)

ROOT.warë¼ê³  íŒŒì¼ëª…ì„ ìˆ˜ì •í•œ ì´ìœ ëŠ” ë‚˜ì¤‘ì— ë¸Œë¼ìš°ì €ì— <br>

```
http://ì„œë²„_IP:8080/creator_hub-0.0.1-SNAPSHOT/home
```

ì´ëŸ°ì‹ìœ¼ë¡œ ì ‘ê·¼ì„ í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— í„°ë¯¸ë„ ì°½ì—ì„œ<br>

```
mv build/libs/waríŒŒì¼ëª….war build/libs/ROOT.war
```

ìˆ˜ì •í•´ì£¼ë©´ ì¢‹ë‹¤(?) ê·¸ ì´ìœ ëŠ” í•˜ë‹¨ì— í•„ìê°€ ë§Œë‚œ ì—ëŸ¬ì—ì„œ ì•Œ ìˆ˜ ìˆë‹¤. <br>

web.xmlì„ ìˆ˜ì •í•´ë„ ë˜ì§€ë§Œ ì˜µì…˜ì´ë‹ˆ.. ì°¾ì•„ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.

## ğŸ’¡ STEP 2. ì›¹ì„œë²„(ubuntu)ì— JDK,tomcatì„¤ì¹˜ 

í•„ìëŠ” java 17, tomcat 11ë²„ì „ìœ¼ë¡œ ì„¤ì¹˜í–ˆë‹¤.
ì°¸ê³ ë¡œ java 17ë²„ì „ì„ ì‚¬ìš©í•œë‹¤ë©´ tomcat 10ë²„ì „ ì´ìƒìœ¼ë¡œ ì„¤ì¹˜í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

```
sudo apt update
sudo apt install openjdk-17-jdk // JAVA 17ì„¤ì¹˜
cd /opt
// tomcat ì„¤ì¹˜
sudo wget sudo wget https://downloads.apache.org/tomcat/tomcat-11/v11.0.0/bin/apache-tomcat-11.0.0.tar.gz 
// ì••ì¶• í•´ì œ
sudo tar xzf apache-tomcat-11.0.0.tar.gz
sudo mv apache-tomcat-11.0.0 tomcat
```

ì°¸ê³ ë¡œ í†°ìº£ ë²„ì „ì´ ì•ˆë§ìœ¼ë©´ ì„¤ì¹˜ê°€ ì•ˆë˜ë‹ˆ ì•„ë˜ ì‚¬ì´íŠ¸ë¡œ ì´ë™í•˜ì—¬ ë²„ì „ì„ ì˜ í™•ì¸í•´ì•¼í•œë‹¤.<br>

[tomcat ë²„ì „](https://archive.apache.org/dist/tomcat/)<br>

ê·¸ ë‹¤ìŒ í†°ìº£ì´ ì‹¤í–‰ë˜ëŠ”ì§€ í™•ì¸

```
cd /opt/tomcat/bin // ì—¬ê¸°ì„œ Permission deniedê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.
sudo ./startup.sh
```

í˜¹ì‹œë‚˜ Permission denied ë°œìƒí•œë‹¤ë©´<br>

```
# í†°ìº£ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /opt

# í†°ìº£ ë””ë ‰í† ë¦¬ì˜ ê¶Œí•œ í™•ì¸
ls -l

# í†°ìº£ ë””ë ‰í† ë¦¬ ê¶Œí•œ ìˆ˜ì • (ì†Œìœ ìë¥¼ í˜„ì¬ ì‚¬ìš©ìë¡œ ë³€ê²½)
sudo chown -R $USER:$USER tomcat
```

ê¶Œí•œ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤.<br>


## ğŸ’¡ STEP 3. ë¡œì»¬ì—ì„œ SCP ëª…ë ¹ì–´ë¡œ WARíŒŒì¼ì„ ìš°ë¶„íˆ¬ ì„œë²„ë¡œ ì „ì†¡

ì¼ë‹¨ waríŒŒì¼ì˜ ê²½ë¡œ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤.(í”„ë¡œì íŠ¸ í´ë”ì— ë“¤ì–´ê°€ì„œ build->libs->waríŒŒì¼) <br>

ê·¸ ë‹¤ìŒ ë¡œì»¬ cmdì°½ì—ì„œ <br>

```
scp "C:\path\creator_hub\build\libs\waríŒŒì¼ëª….war" username@ubuntu_server_ip:/opt/tomcat/webapps/
```

waríŒŒì¼ì„ ì „ì†¡í•œë‹¤. <br>

```
Are you sure you want to continue connecting (yes/no/[fingerprint])? ë‚˜ì˜¤ë©´ YES
```

ì›¹ì„œë²„ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ë©´ ì „ì†¡ ì™„ë£Œ.<br>

íŒŒì¼ ì „ì†¡ì´ ì˜ ë˜ì—ˆëŠ”ì§€ ì›¹ì„œë²„ì—ì„œ waríŒŒì¼ì„ í™•ì¸í•´ì¤€ë‹¤.<br>

```
cd /opt/tomcat/webapps
ls
```

ì¤‘ê°„ ì¤‘ê°„ ê¶Œí•œì— ëŒ€í•œ ê±°ë¶€ ë©”ì„¸ì§€ê°€ ë°œìƒí•˜ë©´ í•´ë‹¹ í´ë” ê²½ë¡œ ì•ì— ls -l /ê²½ë¡œëª…
í•´ì£¼ë©´ ê¶Œí•œ ëª©ë¡ì´ ë‚˜ì˜¤ëŠ”ë° ìœ„ì— ëª…ë ¹ì–´ë¥¼ ì°¸ê³ í•´ì„œ ê¶Œí•œ ìˆ˜ì •ì„ í•´ì£¼ë©´ ëœë‹¤. 

ê·¸ëŸ¬ë©´ ì´ì œ í†°ìº£ì„ ì¬ì‹œì‘ í•˜ë©´ ë.

```
sudo /opt/tomcat/bin/shutdown.sh
sudo /opt/tomcat/bin/startup.sh
```


#### ğŸ’¡ í•„ìš”ì‹œ ìœ ìš©í•œ ëª…ë ¹ì–´ ëª¨ìŒ

```
//(ì—ëŸ¬) ì˜¤ë¥˜ë©”ì„¸ì§€ ë¡œê·¸ íŒŒì¼ ë‚´ìš© í™•ì¸
sudo cat /opt/tomcat/logs/catalina.out
//(ì—ëŸ¬) ì˜¤ë¥˜ë©”ì„¸ì§€ë¡œê·¸ íŒŒì¼ ë§ˆì§€ë§‰ ë¶€ë¶„ í™•ì¸
sudo tail -n 100 /opt/tomcat/logs/catalina.out
// í†°ìº£ ìƒíƒœ í™•ì¸
ps aux | grep tomcat
```


## ğŸ”’ css,jsíŒŒì¼ì´ ë¡œë“œê°€ ì•ˆë˜ëŠ” ì˜¤ë¥˜

css,jsíŒŒì¼ì„ resources/static ì•„ë˜ ë‘ì—ˆëŠ”ë°, ì›¹ì„œë²„ ë°°í¬ì‹œ ë¸Œë¼ìš°ì €ì— <br>

```
Whitelabel Error Page
This application has no explicit mapping for /error, so you are seeing this as a fallback.

Thu Oct 24 14:13:25 UTC 2024
There was an unexpected error (type=Not Found, status=404). 
```

ê·¸ë¦¬ê³  console

```
failed to load resource: the server responded with a status of 404 ()
```

cssë‘ jsíŒŒì¼ì´ ë¡œë“œê°€ ì•ˆë˜ê³  ìˆì—ˆë‹¤.<br>


ê²½ë¡œê°€ ì˜ëª»ë˜ì—ˆë‹¤ë¼ëŠ” ìƒê°ì— ì¼ë‹¨ jspíŒŒì¼ì„ ë‹¤ì‹œ í™•ì¸í–ˆê³ , application.properties ì„¤ì •ë„ ë‹¤ì‹œ í™•ì¸í–ˆë‹¤. <br>

```java
// jsp íŒŒì¼
<c:set var="path" value="${pageContext.request.contextPath}"/>
    <script src="${path}/js/index.js"></script>
    <link rel="stylesheet" href="${path}/css/index.css"/>
```

```
spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp
server.servlet.jsp.init-parameters.development=true
spring.web.resources.static-locations=classpath:/static/
```

ì„¤ì •ì€ ì•„ì£¼ ì˜ ë˜ì–´ ìˆë‹¤.<br>
ì™œ ê·¸ë ‡ê²Œ ìƒê°í–ˆëƒë©´ ë¡œì»¬ì—ì„œëŠ” ì‹¤í–‰ì´ ì˜ ë˜ê³  ìˆê¸° ë•Œë¬¸ì—<br>
controller getmappingì´ë‚˜ jspíŒŒì¼ì´ë‚˜ ê²½ë¡œ ì„¤ì •ì—ëŠ” ë¬¸ì œê°€ ì—†ë‹¤. <br>
ê·¸ë ‡ë‹¤ë©´ ì›¹ì„œë²„ì—ì„œ ê²½ë¡œë¥¼ ì°¾ì„ ë•Œ ë­”ê°€ ë¬¸ì œê°€ ìˆë‹¤ê³  ìƒê°ì´ ë“¤ì—ˆë‹¤. <br>


### ğŸ”“ ë¬¸ì œ í•´ê²° ê³¼ì •

css,jsíŒŒì¼ì´ waríŒŒì¼ì— ì œëŒ€ë¡œ ì˜ í¬í•¨ë˜ì—ˆëŠ”ì§€ ë¨¼ì € í™•ì¸ì´ í•„ìš”í–ˆê³ <br>

ë¸Œë¼ìš°ì €ì— http://ì„œë²„_IP:8080/css/style.css ì ‘ì† <br>
cssíŒŒì¼ì´ ì˜ ë¡œë“œ ë˜ê³  ìˆì—ˆë‹¤. 

console ë‹¤ì‹œ í™•ì¸

```
http://ì›¹ì„œë²„IPì£¼ì†Œ/css/index.css net::ERR_ABORTED 404 (Not Found)
```

step1ì—ì„œ í•„ìê°€ waríŒŒì¼ëª…ì„ ë°”ê¾¼ ì´ìœ ê°€ ë°”ë¡œ ì´ê±°ì˜€ë‹¤.<br>
ë¸”ë¡œê·¸ë¥¼ ì •ë¦¬í•˜ë©´ì„œ waríŒŒì¼ëª…ì„ ë¯¸ë¦¬ ìˆ˜ì •í•˜ë„ë¡ í•´ì•¼ ì´ëŸ° ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒ ê°™ì•˜ë‹¤.<br>

ì´ì „ì—ëŠ” ì›¹ë¸Œë¼ìš°ì €ì— ì ‘ì†í•˜ê¸° ìœ„í•´ì„œëŠ” **http://ì›¹ì„œë²„IPì£¼ì†Œ/waríŒŒì¼ëª…**ì´ í•„ìš”í–ˆê³  jspíŒŒì¼ì— cssíŒŒì¼ ê²½ë¡œê°€ <br>
ë‹¹ì—°íˆ ipì£¼ì†Œ/css/index.cssë¡œ ë˜ì–´ìˆìœ¼ë‹ˆ cssíŒŒì¼ì„ ë¡œë“œí•˜ì§€ ëª»í–ˆë˜ ê²ƒì´ë‹¤. <br>
ê·¸ë˜ì„œ íŒŒì¼ëª…ë§Œ ìˆ˜ì •í•´ì£¼ì—ˆë”ë‹ˆ ë°”ë¡œ ë¡œë“œê°€ ë˜ì—ˆê³  ì˜¤ëŠ˜ì˜ ëª©í‘œì˜€ë˜ ì›¹ì„œë²„ ë°°í¬ê°€ ëë‚¬ë‹¤...<br>


![image](https://github.com/user-attachments/assets/495e18e7-79d3-49d0-a123-783f2c58a386)

ë„ì»¤ ì»´í¬ì¦ˆë¡œ ë°°í¬í•´ë³´ê³  ì‹¶ì—ˆì§€ë§Œ... ë‹¤ìŒ ê¸°íšŒì—..









